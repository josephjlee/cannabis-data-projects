---
title: "README - Wrangling cannabis data"
author: "Martin Frigaard"
date: "current version: `r Sys.Date()`"
output: github_document
---


```{r setup, include=FALSE}
library(knitr)
library(rmdformats)
require(tidyverse)
library(plotly)
require(janitor)
require(skimr)
library(mosaic)
library(inspectdf)
library(visdat)
library(DT)
library(hrbrthemes)
# base options ----
base::options(
  tibble.print_max = 25,
  tibble.width = 78,
  scipen = 100000000,
  max.print = 999999
)
# knitr chunk options ----
knitr::opts_chunk$set(
  echo = TRUE, # show/hide all code
  # results = "hide", # hide results
  tidy = FALSE, # cleaner code printing
  comment = "#> ", # better console printing
  eval = TRUE, # turn this to FALSE stop code chunks from running
  message = TRUE, # show messages
  fig.width = 9, # figure width
  fig.height = 6, # figure height
  warning = FALSE, # show warnings
  size = "small", # size of the text
  fig.path = "figs/"
) # location of files
# knitr knit settings ----
knitr::opts_knit$set(
  width = 78
)
# set theme
ggplot2::theme_set(theme_ipsum_tw(
  base_family = "DroidSansMono",
  base_size = 10,
  strip_text_size = 9,
  plot_title_family = "TitilliumWeb-SemiBold",
  plot_title_size = 20,
  axis_title_family = "Ubuntu",
  axis_title_size = 13
))
```

# Motivation

This script outlines the steps to wrangle the Cannabis and Online Retail data.

## Import Online Retail data 

This data came from a UK e-commerce dataset from the [UCI Machine Learning Laboratory](https://archive.ics.uci.edu/ml/datasets/online+retail). 

```{r import-OnlineRetail}
# fs::dir_tree("data")
OnlineRetail <- readr::read_csv("data/raw/Online_Retail.csv",
                                col_types = cols(
                                InvoiceNo = col_character(),
                                StockCode = col_character(),
                                Description = col_character(),
                                Quantity = col_integer(),
                                InvoiceDate = col_datetime("%m/%d/%Y %H:%M"),
                                UnitPrice = col_double(),
                                CustomerID = col_integer(),
                                Country = col_character()))
```

```{r str-OnlineRetail}
dplyr::glimpse(OnlineRetail)
```

There are 8 variables in this data frame. 

```{r skim-OnlineRetail}
skimr::skim(OnlineRetail)
```


## Import kushy data 

```{r kushy_files}
kushy_files <- fs::dir_ls("data/kushy-datasets", regexp = "kushy_")
# kushy_files[4]
KushyBrands <- readr::read_csv(kushy_files[1])
KushyProducts <- readr::read_csv(kushy_files[2])
KushyShops <- readr::read_csv(kushy_files[3])
KushyStrains <- readr::read_csv(kushy_files[4])
```

### Categorical data 

These are the categories in the `KushyBrands` data frame. 

```{r cat-KushyBrands}
kushy_brands_inspect_cat <- KushyBrands %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_cat() 
kushy_brands_inspect_cat %>% 
    inspectdf::show_plot()
```

```{r cat-KushyProducts}
kushy_products_inspect_cat <- KushyProducts %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_cat() 
kushy_products_inspect_cat %>% 
    inspectdf::show_plot()
```

```{r cat-KushyShops}
kushy_shops_inspect_cat <- KushyShops %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_cat()
kushy_shops_inspect_cat %>% 
    inspectdf::show_plot(text_labels = TRUE)
```

```{r cat-KushyStrains}
kushy_strains_inspect_cat <- KushyStrains %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_cat()
kushy_strains_inspect_cat %>% 
    inspectdf::show_plot(text_labels = TRUE)
```

## Missing Kushy data 

These plots show the missing data 

```{r kushy_brands_inspect_na}
kushy_brands_inspect_na <- KushyBrands %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_na()
kushy_brands_inspect_na %>% 
    inspectdf::show_plot(text_labels = TRUE)
```

```{r kushy_products_inspect_na}
kushy_products_inspect_na <- KushyProducts %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_na()
kushy_products_inspect_na %>% 
    inspectdf::show_plot(text_labels = TRUE)
```


```{r kushy_shops_inspect_na}
kushy_shops_inspect_na <- KushyShops %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_na()
kushy_shops_inspect_na %>% 
    inspectdf::show_plot(text_labels = TRUE)
```

```{r kushy_strains_inspect_na}
kushy_strains_inspect_na <- KushyStrains %>% 
    select_if(is.character) %>% 
    inspectdf::inspect_na()
kushy_strains_inspect_na %>% 
    inspectdf::show_plot(text_labels = TRUE)
```
